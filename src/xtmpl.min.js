!function(a,b){var c={trim:function(a){return(a+"").replace(/^\s*/,"").replace(/\s*$/,"")},convertDotNumberToBracket:function(a){return(a||"").replace(/\.(?:\$_)?(\d+)(\.|$)/g,"[$1]$2")}},d={},e={},f={},g={escapeHtml:!0,startTag:"{{",endTag:"}}",blockHelperFlag:"#",resultVarName:"$html"};d.registerBlockHelper=function(a,b){e[a]=b},d.registerInlineHelper=function(a,b){f[a]=b},d.config=function(a,b){if("string"==typeof a)g[a]=b;else for(var c in a)g[c]=a[c]},d._concatParam=function(a,b){var d=g.resultVarName+" += ";return g.escapeHtml&&b&&(d+="$escape("),d+=c.convertDotNumberToBracket(a),g.escapeHtml&&b&&(d+=")"),d+=";\n"},d._concat=function(a){return a=(a||"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),g.resultVarName+' += "'+a+'";\n'},d._addParam=function(a,b,c){for(var d=b[b.length-1],e="",f=function(a,b){var d=b.length/3;return c[c.length-d-1]+"."},g=0;g<a.length;g+=1){var h=a[g];if(!d[h]&&!/\.this$|\$data$/.test(h)){d[h]=1,/\//.test(h)&&(h=h.replace(/^[^.]+\./,""),h=0===h.indexOf("/")?c[0]+"."+h.slice(1):h.replace(/^((?:\.\.\/)+)/,f));var i=h.split(".");d[i[1]]||(d[i[1]]=1,e+="var "+i[1]+" = ",e+=i[0]+'["'+i[1].replace(/^\$_(\d+)$/,"$1")+'"];\n')}}return e},d._resolveBlockHelperCode=function(a,b){var c={env:"",variable:[],str:""};a=a.slice(1);var d=a.split(/\s+/),f=e[d[0]];if(!f)throw new Error("has no block helper named "+d[0]);for(var g=1;g<d.length;g+=1)"this"===d[g]&&(d[g]=b);var h=f.call(null,b,d.slice(1));return[].push.apply(c.variable,h.variable),c.env=h.env,h.noFunction?c.str=h.str:c.str="(function () {\n"+h.str,c},d._resolveInlineHelperCode=function(a,b,e){var g={env:"",variable:[],str:""},h=c.trim(a).split(/\s+/),i=h[0],j=f[i];if(!j)throw new Error("has no inline helper named "+h[0]);g.variable.push("$helper."+i),h=h.slice(1);for(var k=/^(?:(['"])[\S]*\1|[\d.]+|true|false)$/,l=0;l<h.length;l+=1){var m=h[l];"this"===m?h[l]=b:!k.test(m)&&/^[$\w_]+$/.test(m)?g.variable.push(b+"."+m):h[l]=d._resolveParam(m,b,g)}return g.str=i+"("+h.join(",")+")",g.str=d._concatParam(g.str,e),g},d._resolveParam=function(a,b,c){return/^(?:(['"])[\S]*\1|[\d.]+|true|false)$/.test(a)?a:(a=a.replace(/^this\./,""),"this"===a?a=b:0!==a.indexOf("$")?(a=a.replace(/(\.|^)(\d+)(\.|$)/,"$1$_$2$3"),c.variable.push(b+"."+a)):a=a.replace(/(\.|^)(\d+)(\.|$)/,"[$2]$3"),a.replace(/^[.\/]*/g,""))},d._resolveCode=function(a,b){var f={env:"",variable:[],str:""};if(0===a.indexOf(g.blockHelperFlag)){var h=a.indexOf("/")===a.length-1;h&&(a=a.slice(0,-1)),f=d._resolveBlockHelperCode(a,b)}else if(0===a.indexOf("/")&&e[a.slice(1)])f.env="..",f.str="}})();\n";else{var i=!0;0===a.indexOf("=")&&(a=a.slice(1),i=!1);var j=c.trim(a).split(/\s+/);1===j.length?f.str=d._concatParam(d._resolveParam(j[0],b,f),i):f=d._resolveInlineHelperCode(a,b,i)}return f},d.compile=function(b){var e=["$data"],h=[{}],i="";if(i+='var $html = "";\n',g.escapeHtml&&(i+=d._addParam(["$helper.$escape"],h,e)),!/[^\w-]/.test(b)&&a.document){var j=a.document.getElementById(b);j&&(b=j.value||j.innerHTML)}b=c.trim(b);for(var k=b.split(g.startTag),l=0;l<k.length;l+=1){var m=k[l];if(0!==l){var n=m.split(g.endTag),o=d._resolveCode(n[0],e[e.length-1]);".."===o.env?(e.pop(),h.pop()):o.env&&(e.push(o.env),h.push({})),i+=d._addParam(o.variable,h,e),i+=o.str,""!==n[1]&&(i+=d._concat(n[1]))}else""!==m&&(i+=d._concat(m))}i+="return $html;";var p=new Function("$data","$helper",i),q=function(a){return p(a,f)};return q.toString=function(){return i},q},d._util=c,a.xtmpl=d}(this),function(a){a.registerBlockHelper("if",function(b,c){for(var d={env:b,variable:[],str:""},e=0;e<c.length;e+=1){var f=c[e],g=!1;0===f.indexOf("!")&&(f=f.slice(1),g=!0),/^['"]|^[\d.]$|^\W|true|false/.test(f)||d.variable.push(b+"."+f),c[e]=a._util.convertDotNumberToBracket(f),g&&(c[e]="!"+f)}return d.str="if ("+c.join("")+") {\n",d}),a.registerBlockHelper("else",function(a,b){return{noFunction:!0,env:b[0],variable:[],str:"} else {\n"}}),a.registerBlockHelper("with",function(a,b){return{env:b[0],variable:[a+"."+b[0]],str:"{"}}),a.registerBlockHelper("for",function(a,b){var c=b[0],d={env:"$value",variable:[a+"."+c],str:""};return d.str="for (var $key = 0; $key < "+c+".length; $key++) {\n",d.str+="var $value = "+c+"[$key];\n",d}),a.registerBlockHelper("forin",function(a,b){var c={env:"$value",variable:[a+"."+b[0]],str:""};return c.str="for (var $key in "+b[0]+") {\n",c.str+="var $value = "+b[0]+"[$key];\n",c}),a.registerBlockHelper("each",function(a,b){var c=b[0],d={env:"$value",variable:[a+"."+c],str:""},e="var $eachData = "+c+";\n";return e+="if (({}).toString.call("+c+') === "[object Array]") {\n',e+="$eachData = {};\n",e+="for (var $key = 0; $key < "+c+".length; $key += 1) {\n",e+="$eachData[$key]="+c+"[$key];\n",e+="}\n",e+="}\n",e+="for (var $key in $eachData) {\n",e+="var $value = $eachData[$key];\n",d.str=e,d});var b={"&":"&amp;",'"':"&quot;","'":"&#39;","/":"&#x2f;","<":"&lt;",">":"&gt;",reg:/[&"'<>\/]/g};a.registerInlineHelper("$escape",function(a){return(a+"").replace(b.reg,function(a){return b[a]})})}(this.xtmpl),function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a:"function"==typeof define&&define.amd&&define(function(){return a})}(this.xtmpl);