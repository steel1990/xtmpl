!function(a){var b={trim:function(a){return(a+"").replace(/^\s*/,"").replace(/\s*$/,"")}},c={},d={},e={},f={escapeHtml:!0,startTag:"{{",endTag:"}}",blockHelperFlag:"#",resultVarName:"$html"};c.registerBlockHelper=function(a,b){d[a]=b},c.registerInlineHelper=function(a,b){e[a]=b},c.config=function(a,b){if("string"==typeof a)f[a]=b;else for(var c in a)f[c]=a[c]},c._concatParam=function(a,b){var c=f.resultVarName+" += ";return f.escapeHtml&&b&&(c+="$escape("),c+=a,f.escapeHtml&&b&&(c+=")"),c+=";\n"},c._concat=function(a){return a=(a||"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),f.resultVarName+' += "'+a+'";\n'},c._addParam=function(a,b,c){for(var d=b[b.length-1],e="",f=function(a,b){var d=b.length/3;return c[c.length-d-1]+"."},g=0;g<a.length;g+=1){var h=a[g];if(!d[h]&&!/\.this$|\$data$/.test(h)){d[h]=1,/\//.test(h)&&(h=h.replace(/^[^.]+\./,""),h=0===h.indexOf("/")?c[0]+"."+h.slice(1):h.replace(/^((?:\.\.\/)+)/,f));var i=h.split(".");i[1]=i[1].split(".")[0],e+="var "+i[1]+" = "+i[0]+'["'+i[1]+'"];\n'}}return e},c._resolveBlockHelperCode=function(a,b){var c={env:"",variable:[],str:""};a=a.slice(1);var e=a.split(/\s+/),f=d[e[0]];if(!f)throw new Error("has no block helper named "+e[0]);for(var g=1;g<e.length;g+=1)"this"===e[g]&&(e[g]=b);var h=f.call(null,b,e.slice(1));return[].push.apply(c.variable,h.variable),c.env=h.env,c.str="(function () {\n"+h.str,c},c._resolveInlineHelperCode=function(a,d,f){var g={env:"",variable:[],str:""},h=b.trim(a).split(/\s+/),i=h[0],j=e[i];if(!j)throw new Error("has no inline helper named "+h[0]);g.variable.push("$helper."+i),h=h.slice(1);for(var k=/^(?:(['"])[\S]*\1|[\d.]+|true|false)$/,l=0;l<h.length;l+=1){var m=h[l];"this"===m?h[l]=d:!k.test(m)&&/^[$\w_]+$/.test(m)&&g.variable.push(d+"."+m)}return g.str=i+"("+h.join(",")+")",g.str=c._concatParam(g.str,f),g},c._resolveCode=function(a,e){var g={env:"",variable:[],str:""};if(0===a.indexOf(f.blockHelperFlag))g=c._resolveBlockHelperCode(a,e);else if(0===a.indexOf("/")&&d[a.slice(1)])g.env="..",g.str="}})();\n";else{var h=!0;0===a.indexOf("=")&&(a=a.slice(1),h=!1);var i=b.trim(a).split(/\s+/);1===i.length?("this"===i[0]?i[0]=e:0!==i[0].indexOf("$")&&g.variable.push(e+"."+i[0]),g.str=c._concatParam(i[0].replace(/^[.\/]*/g,""),h)):g=c._resolveInlineHelperCode(a,e,h)}return g},c.compile=function(d){var g=["$data"],h=[{}],i="";if(i+='var $html = "";\n',f.escapeHtml&&(i+=c._addParam(["$helper.$escape"],h,g)),!/[^\w-]/.test(d)&&a.document){var j=a.document.getElementById(d);j&&(d=j.value||j.innerHTML)}d=b.trim(d);for(var k=d.split(f.startTag),l=0;l<k.length;l+=1){var m=k[l];if(0!==l){var n=m.split(f.endTag),o=c._resolveCode(n[0],g[g.length-1]);".."===o.env?(g.pop(),h.pop()):o.env&&(g.push(o.env),h.push({})),i+=c._addParam(o.variable,h,g),i+=o.str,""!==n[1]&&(i+=c._concat(n[1]))}else""!==m&&(i+=c._concat(m))}i+="return $html;";var p=new Function("$data","$helper",i),q=function(a){return p(a,e)};return q.toString=function(){return i},q},c._util=b,a.xtmpl=c}(this),function(a){a.registerBlockHelper("if",function(a,b){for(var c={env:a,variable:[],str:""},d=0;d<b.length;d+=1){var e=b[d],f=!1;0===e.indexOf("!")&&(e=e.slice(1),f=!0),/^['"]|^[\d.]$|^\W|true|false/.test(e)||c.variable.push(a+"."+e),f&&(b[d]="!"+e)}return c.str="if ("+b.join("")+") {\n",c}),a.registerBlockHelper("with",function(a,b){return{env:b[0],variable:[a+"."+b[0]],str:"{"}}),a.registerBlockHelper("for",function(a,b){var c=b[0],d={env:"$value",variable:[a+"."+c],str:""};return d.str="for (var $key = 0; $key < "+c+".length; $key++) {\n",d.str+="var $value = "+c+"[$key];\n",d}),a.registerBlockHelper("forin",function(a,b){var c={env:"$value",variable:[a+"."+b[0]],str:""};return c.str="for (var $key in "+b[0]+") {\n",c.str+="var $value = "+b[0]+"[$key];\n",c}),a.registerBlockHelper("each",function(a,b){var c=b[0],d={env:"$value",variable:[a+"."+c],str:""},e="var $eachData = "+c+";\n";return e+="if (({}).toString.call("+c+') === "[object Array]") {\n',e+="$eachData = {};\n",e+="for (var $key = 0; $key < "+c+".length; $key += 1) {\n",e+="$eachData[$key]="+c+"[$key];\n",e+="}\n",e+="}\n",e+="for (var $key in $eachData) {\n",e+="var $value = $eachData[$key];\n",d.str=e,d});var b={"&":"&amp;",'"':"&quot;","'":"&#39;","/":"&#x2f;","<":"&lt;",">":"&gt;",reg:/[&"'<>\/]/g};a.registerInlineHelper("$escape",function(a){return(a+"").replace(b.reg,function(a){return b[a]})})}(this.xtmpl),function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a:"function"==typeof define&&define.amd&&define(function(){return a})}(this.xtmpl);